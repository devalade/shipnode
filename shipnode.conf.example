# ShipNode Configuration File
# Copy this to shipnode.conf and customize for your project

# ============================================
# App Type
# ============================================
# Options: "backend" or "frontend"
# - backend: Node.js app with PM2 process management
# - frontend: Static files (React, Vue, etc.)
APP_TYPE=backend

# ============================================
# SSH Connection
# ============================================
SSH_USER=root
SSH_HOST=your-server-ip
SSH_PORT=22

# ============================================
# Node.js Version
# ============================================
# Node.js major version to install on remote server
# Options: "lts" (recommended), "20", "22", "18", etc.
# Use major version only (not 22.14.0, just 22)
# Default: lts
NODE_VERSION=lts

# ============================================
# Deployment Path
# ============================================
# Where your app will be deployed on the server
REMOTE_PATH=/var/www/myapp

# ============================================
# Backend-specific Settings
# ============================================
# Required if APP_TYPE=backend
PM2_APP_NAME=myapp
BACKEND_PORT=3000

# ============================================
# Frontend-specific Settings (Optional)
# ============================================
# Domain name for Caddy configuration
# Leave empty to skip Caddy setup
DOMAIN=myapp.com

# ============================================
# Optional: Build Directory
# ============================================
# Frontend build output directory
# Default: auto-detect (dist, build, or public)
# BUILD_DIR=dist

# ============================================
# Optional: Environment File
# ============================================
# Local environment file to upload to server
# Default: .env
# ENV_FILE=.env.production

# ============================================
# Zero-Downtime Deployment
# ============================================
# Enable atomic release-based deployments with health checks
ZERO_DOWNTIME=true

# Number of releases to keep (older releases will be deleted)
KEEP_RELEASES=5

# ============================================
# Health Checks (Backend only)
# ============================================
# Enable health checks after deployment
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT=30
HEALTH_CHECK_RETRIES=3

# ============================================
# Pre/Post Deploy Hooks
# ============================================
# ShipNode automatically uses .shipnode/pre-deploy.sh and .shipnode/post-deploy.sh
# if they exist. Run 'shipnode init' to auto-generate these with ORM-specific
# migration commands based on your package.json dependencies.
#
# Pre-deploy hook: Runs after code is deployed and dependencies installed,
# but BEFORE the new release is activated. If this hook fails, the
# deployment is aborted and rolled back.
# Use for: database migrations, Prisma generate, cache warming
#
# Post-deploy hook: Runs after the deployment completes successfully.
# If this hook fails, a warning is logged but the deployment is still
# considered successful.
# Use for: notifications, cache clearing, cleanup tasks
#
# Environment variables available to hooks:
#   RELEASE_PATH     - Path to the release being deployed
#   REMOTE_PATH      - Base deployment path on server
#   PM2_APP_NAME     - PM2 process name (backend only)
#   BACKEND_PORT     - Application port (backend only)
#   SHARED_ENV_PATH  - Path to shared .env file
#
# Advanced: Override default hook paths (rarely needed)
# PRE_DEPLOY_SCRIPT=.shipnode/pre-deploy.sh
# POST_DEPLOY_SCRIPT=.shipnode/post-deploy.sh

# ============================================
# PostgreSQL Database Setup
# ============================================
# Enable PostgreSQL installation and setup
DB_SETUP_ENABLED=true

# Database name to create
DB_NAME=myapp_db

# Database user to create
DB_USER=myapp_user

# Database password for the user
# You can reference .env variables directly:
#   DB_PASSWORD=$DB_PASSWORD
# Or use defaults: DB_PASSWORD=${DB_PASSWORD:-fallback_value}
DB_PASSWORD=${DB_PASSWORD:-}
